# SMC Animation Viewer

Interactive Smart Money Concepts animation viewer built with Next.js and Plotly.js. Replaces pre-rendered GIF output with a browser-based visualization where you can scrub the timeline, toggle indicators, and jump to events.

## Features

- **Chart selector**: Switch between datasets (e.g. 23m, 1D) via dropdown in the header
- **Playback**: Play / Pause, step forward/back, reverse, speed slider (0.25×–4×)
- **Timeline**: Scrubber to jump to any frame
- **Indicators**: Toggle Candles, FVG, Swing H/L, BOS, CHoCH, Order blocks, Liquidity, PH/PL, Sessions, Retracements
- **Jump to event**: Dropdown to jump to first/last BOS, CHoCH, FVG, liquidity sweep, OB
- **Time display**: Current frame time in 12-hour AM/PM Eastern (EST/EDT)
- **Responsive chart**: Chart fills its container and resizes with the window

## Prerequisites

- Node.js 18+ and npm
- (Optional) Python 3 with the project’s `smartmoneyconcepts` package, to regenerate frame data from CSV

## Quick start

1. Install dependencies and run the dev server:

   ```bash
   cd smc-viewer
   npm install
   npm run dev
   ```

2. Open [http://localhost:3009/smc-viewer](http://localhost:3009/smc-viewer).

The app loads available datasets from `public/data/datasets.json` and frame data from `public/data/`. A pre-generated dataset (KCEX ETHUSDT 23m, 400 frames) is included. Use the chart dropdown in the header to switch between datasets.

## Generating frame data from your own CSV

Frame JSON is produced by the Python export script in the repo root. From the **project root** (not `smc-viewer`):

1. Use a virtualenv and install the package:

   ```bash
   python3 -m venv .venv
   source .venv/bin/activate   # Windows: .venv\Scripts\activate
   pip install -e .
   ```

2. Run the export script (default CSV: `KCEX_ETHUSDT.P, 23_ce49b.csv` in project root):

   ```bash
   python scripts/export_smc_frames.py "KCEX_ETHUSDT.P, 23_ce49b.csv" --last 500 --window 100 --out smc-viewer/public/data/smc_frames.json
   ```

   Options:

   - `--last N` – use last N bars (default: 500)
   - `--window N` – sliding window size in bars (default: 100)
   - `--out PATH` – output JSON path
   - `--timeframe LABEL` – label for meta (e.g. `23m`)

3. For a **new dataset** (e.g. 1D), output to a separate file and add it to the manifest:

   ```bash
   python scripts/export_smc_frames.py "KCEX_ETHUSDT.P, 1D_42991.csv" --last 500 --window 100 --out smc-viewer/public/data/smc_frames_1d.json --timeframe "1D"
   ```

   Then add an entry to `smc-viewer/public/data/datasets.json`:

   ```json
   {"id": "1d", "path": "smc_frames_1d.json", "label": "KCEX ETH 1D"}
   ```

4. Restart or refresh the viewer; it will load the new data. Use the chart dropdown to switch.

## Tech stack

- **Next.js** (App Router), **TypeScript**, **Tailwind CSS**, **shadcn/ui**
- **Plotly.js** (via `react-plotly.js` + `plotly.js-dist-min`) for the chart

## Project structure

- `app/smc-viewer/page.tsx` – viewer page, loads JSON and wires playback/indicators
- `components/` – chart, playback controls, indicator panel, jump-to-event dropdown
- `lib/` – types (`smc-types.ts`), frame → Plotly conversion (`frame-to-plotly.ts`), player hook (`use-smc-player.ts`), time formatting (`format-time.ts`)
- `public/data/smc_frames.json` – frame dataset (generated by `scripts/export_smc_frames.py` in repo root)

## Build

```bash
npm run build
npm start
```

Production build serves the same routes; open `/smc-viewer` for the viewer.
